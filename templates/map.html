{% extends "base.html" %}

{% block title %}
    {% firstof bmap.name "GeoNotice" %}
{% endblock %}

{% block pagecss %}
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.5/leaflet.css" />
<link rel="stylesheet" href="{{ STATIC_PREFIX }}leaflet.draw/leaflet.draw.css" />
<link href="{{ STATIC_PREFIX }}bootstrap-editable/css/bootstrap-editable.css" rel="stylesheet">
<!--[if lte IE 8]><link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.5/leaflet.ie.css" /><![endif]-->
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.4.5/leaflet.css" />
<link rel="stylesheet" href="{{ STATIC_PREFIX }}css/base.css">
<link rel="stylesheet" href="{{ STATIC_PREFIX }}css/map.css">
{% endblock %}

{% block content %}
<!--[if lt IE 8]>
    <p class="chromeframe">You are using an outdated browser. <a href="http://browsehappy.com/">Upgrade your browser today</a> or <a href="http://www.google.com/chromeframe/?redirect=true">install Google Chrome Frame</a> to better experience this site.</p>
<![endif]-->
<div id="topbar">
    <a class="brand" href="/">GeoNotice</a>
    <div class="pull-right">
        {{site.name}} <a id="userguide"><i class="icon-cog"></i></a>
    </div>
</div>
</div>
</div>
<div id="midbar">
   <div class="navbar navbar-inverse navbar-static-top hrow">
        <div class="navbar-inner">
            <ul class="nav pull-left">
                <li>
                <a id='nav-tools'>Tools <span class="downcaret">&#9660;</span></a>
                </li>
            </ul>
            <div class="pull-right">
                <ul class="nav pull-right">
                      <form class="navbar-search" action="">
                          <input placeholder="search" autocomplete="off" type="text" id="search" class="search-query input-xlarge" data-link="/search/"><span class="fornav"><i class="icon-search"></i></span>
                      </form>
                </ul>
          </div>
            <div id="map-title">
                <a href="#" id="map-title-editable">{{ bmap.name|default:"" }}</a><i class="icon-pencil fade"></i>
            </div>
        </div>
    </div>   
</div>   
<div class="container-fluid">
<div id="map-area" >
    <div id="actions">
        <div id="map-actions" class="all-actions">
            <a id="pick" class="btn btn-block">Single</a>
            <a id="lasso" class="btn btn-block ">Lasso</a>
            <a id="addbuffer" class="btn btn-block">Buffer</a>
            <div id="fullbuffer" class="input-append">
                <button id="buffer" class="btn btn-primary" type="button">Buffer</button>
                <div id="buffer-options" >
                    <input id="bufferdist" class="hideright input-actions" id="appendedInputButtons"
                    type="text" placeholder="300"> <span class="add-on bgwhite ital">feet&nbsp;</span>
                    <button id="dobuffer" class="btn btn-success" type="button">Run</button>
                </div>
            </div>
            <a id="saveButton" class="btn btn-block btn-break">Save Map</i></a>
            <a id="" class="btn btn-block">Share</i></a>
            <a id="newMap" href="/" class="btn btn-block">New</a>
            <a href="/maps/" class="btn btn-block">Saved Maps</a>
            <form id="pdfform" method="post" action="/print/" target="_blank">
                <input type="hidden" class="csrf" name="csrfmiddlewaretoken" value="">
                <input type="hidden" class="data" name="data" />
                <input type="hidden" name="siteid" value="{{site.pk}}" />
            </form>
            <a id="pdfMapButton" class="btn btn-block btn-break">PDF</a>
            <a id="exportButton" class="btn btn-block">Export</a>
        </div>
        <div id="output-actions" class="all-actions">
        </div>
    </div>
    <div id="alerts">
        <div id="save-confirm" class="alert alert-info">
            <button type="button" class="close">&times;</button>
            This map already has been saved. Would like to save over this map, or create a new one?
            <button id="saveold">Save over this map</button><button id="savenew">Save as a new map</button>
        </div>
        <div id="save-needsname" class="alert alert-info">
            <button type="button" class="close">&times;</button>
            Please name this map before saving.
        </div>
        <div id="save-success" class="alert alert-success">
            <button type="button" class="close">&times;</button>
            Map Saved.
        </div>
    </div>
    <div id="info-overlay"><span>...</span></div>
    <div id="data-table">
        <a class="btn closer">&laquo;Back</a>
        <form id="dataform" method="post" action="/data/" target="_blank">
            <input type="hidden" class="csrf" name="csrfmiddlewaretoken" value="">
            <input type="hidden" class="data" name="data" />
            <input type="hidden" id="filetype" name="filetype" />
        </form>
        <a id="labelButton" class="btn">Labels</a>
        <a id="tableButton" class="btn">Table</a>
        <a id="excelButton" class="btn">Excel</a>
        <a id="csvButton" class="btn">CSV</a>
        <form id="label-actions" method="post" action="/labels/" target="_blank">
            <label class="radio inline">
                  <input type="radio" name="optionsRadios" id="optionsMail" value="mail" checked>
                  Use Mailing Address&nbsp;&nbsp;
            </label>
            <label class="radio inline">
                  <input type="radio" name="optionsRadios" id="optionsSitus" value="situs">
                  Use Situs Address&nbsp;&nbsp;
            </label>
            <label class="radio inline">
                  <input type="radio" name="optionsRadios" id="optionsBoth" value="both">
                  Use Both (if different)
            </label>
            <label class="checkbox">
                <input type="checkbox" id="uniquebox">Skip Duplicate Mailing Addresses</input>
            </label>
            <label class="checkbox">
                <input type="checkbox" id="apnbox" checked >Show APNs</input>
            </label>
            <input type="hidden" class="csrf" name="csrfmiddlewaretoken" value="">
            <input type="hidden" class="data" name="data" />
            <button class="btn" id="getLabelButton">Make Labels</button>
        </form>
        <div id="table-container">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th class="span2">APN</th>
                        <th>Owner</th>
                        <th>Situs Address</th>
                        <th>Mailing Address</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
    <div id="map" class="vstretch"></div>
  </div>
</div>
{% endblock %}


{% block pagejs %}
<script type="text/javascript">
    var mapstate = {{ bmap.state|safe }};
    var sitebounds = {{ site.bounds.json|safe }};
    var panbounds = {{site.panbounds|safe }};
</script>
<script src="{{ STATIC_PREFIX }}leaflet/dist/leaflet.js"></script>
<script src="{{ STATIC_PREFIX }}masterblaster/map-base.js"></script>
<script src="{{ STATIC_PREFIX }}leaflet.draw/leaflet.draw.js"></script>
<script src="{{ STATIC_PREFIX }}bootstrap-editable/js/bootstrap-editable.js"></script>
<script src="{{ STATIC_PREFIX }}masterblaster/map-ui.js"></script>
<script src="{{ STATIC_PREFIX }}masterblaster/search.js"></script>
{% endblock %}

